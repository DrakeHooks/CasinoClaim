"use strict";webSafety.webRequest=function(){var e={},t=function(e){var t=e.tabId,a=e.url,n=webSafety,i=n.URI,o=i.hostnameFromURI(a),s=i.domainFromHostname(o)||o,c="",l={rootHostname:o,rootDomain:s,pageHostname:o,pageDomain:s,requestURL:a,requestHostname:o,requestType:"main_frame"};if(""===c&&n.hnSwitches.evaluateZ("no-strict-blocking",o)&&(c="ua:no-strict-blocking: "+n.hnSwitches.z+" true"),""===c&&"a"===(c=r(c,o)).charAt(1)&&(c="ua:no-strict-blocking true (temporary)"),""===c){c=adawareCloudService.filterRequest(l,function(e,r,a){var n=decodeURIComponent(e.substring(4)),i=webSafety,o=i.URI,s=o.hostnameFromURI(n),c=o.domainFromURI(n),l=btoa(JSON.stringify({url:n,hn:s,dn:c,br:r})),u=vAPI.getURL("document-blocked.html?details=")+l;a?i.warningPageUrls[t]=u:vAPI.tabs.replace(t,u)},function(e){var r=decodeURIComponent(e.substring(4));webSafety.webRequest.temporarilyWhitelistDocument(i.hostnameFromURI(r)),vAPI.tabs.replace(t,r)})}if("acs-black-list-hit"===c){var u=new URL(a);if(u.pathname.indexOf(".exe")>-1||u.pathname.indexOf(".msi")>-1)return{redirectUrl:"javascript:"};var m=vAPI.getURL("loading-page.html");return vAPI.chrome?{redirectUrl:m}:(vAPI.tabs.replace(t,m),{cancel:!0})}};vAPI.net.onBeforeRequest={urls:["http://*/*","https://*/*"],extra:["blocking"],callback:function(e){if("main_frame"===e.type)return t(e)}},vAPI.net.registerListeners();var r=function(e,t){for(var r,n;;){if(void 0!==(r=a[t]))if(r>Date.now()){if(""===e)return"ua:* "+t+" doc allow"}else delete a[t];if(-1===(n=t.indexOf(".")))break;t=t.slice(n+1)}return e},a=Object.create(null);return e.temporarilyWhitelistDocument=function(e){"string"==typeof e&&""!==e&&(a[e]=Date.now()+5e3)},e}();